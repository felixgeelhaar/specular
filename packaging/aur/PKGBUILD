# Maintainer: Felix Geelhaar <felix@felixgeelhaar.de>
pkgname=specular
pkgver=1.1.0
pkgrel=1
pkgdesc="AI-Native Spec and Build Assistant with policy enforcement"
arch=('x86_64' 'aarch64')
url="https://github.com/felixgeelhaar/specular"
license=('MIT')
depends=('docker')
optdepends=(
  'git: for version control integration'
  'ollama: for local AI models'
)
provides=('specular')
conflicts=('specular-bin' 'specular-git')
source_x86_64=("${pkgname}-${pkgver}-x86_64.tar.gz::https://github.com/felixgeelhaar/specular/releases/download/v${pkgver}/specular_${pkgver}_linux_amd64.tar.gz")
source_aarch64=("${pkgname}-${pkgver}-aarch64.tar.gz::https://github.com/felixgeelhaar/specular/releases/download/v${pkgver}/specular_${pkgver}_linux_arm64.tar.gz")

# Checksums will be updated after release
sha256sums_x86_64=('SKIP')
sha256sums_aarch64=('SKIP')

package() {
  # Install binary
  install -Dm755 "${srcdir}/specular" "${pkgdir}/usr/bin/specular"

  # Install license
  install -Dm644 "${srcdir}/LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

  # Install documentation
  install -Dm644 "${srcdir}/README.md" "${pkgdir}/usr/share/doc/${pkgname}/README.md"

  # Install shell completions
  install -Dm644 "${srcdir}/completions/specular.bash" "${pkgdir}/usr/share/bash-completion/completions/specular"
  install -Dm644 "${srcdir}/completions/_specular" "${pkgdir}/usr/share/zsh/site-functions/_specular"
  install -Dm644 "${srcdir}/completions/specular.fish" "${pkgdir}/usr/share/fish/vendor_completions.d/specular.fish"
}
